# CSSのセレクタ高速化

2年前に発売された[ハイパフォーマンスWebサイト](http://www.amazon.co.jp/exec/obidos/ASIN/487311361X/ref=nosim/webtech00-22)の続編の[続・ハイパフォーマンスWebサイト](http://www.amazon.co.jp/exec/obidos/ASIN/4873114462/ref=nosim/webtech00-22)を呼んでCSSセレクタの高速化の話しがあったので紹介します。

### 

「セレクタは右から左に解釈される」。これは正直知らなくて、結構衝撃でした。

    #foo .bar {}

これはなんとなく間隔では#fooを探して、その中の.barを探している気がしますけど、実は.barを探して、その親要素に#fooがあるかを探すそうです。なので特に#fooが必要なければ

    .bar {}

と書いたほうが高速だということ。

また、以下の様に要素名で指定すると、その要素を全て探します。

    #foo a {}

これは一度a要素を全て探すので、できればaにclassをふって

    #foo .anchor {}

とするほうが高速のようです。（#fooもとったほうがより高速）

特にユニバーサルセレクタなどは、

    div#foo * {}

とすると、全ての要素の親要素に対してdiv#fooがあるかどうかを調べるので遅くなるようです。

以下の様にidやclassに要素名を書くよりも書かない方が高速らしいです。

    div#foo {}
    li.item {}

これは、以下の様に書いた方がいいとのこと。

    #foo {}
    .item {}

また、子孫セレクタの処理が一番コストがかかるということらしいので、

    div#wrapper div#main ul.list li {}

などとしないでliにclassをふって

    .list-item {}

とするのがよいとされています。

DOM要素の数がすごく多くなるとCSSのセレクタの書き方がネックになることもあるとのことですが（その前に他のところがネックになる気もするけど）、普通のWebサイトつくっててCSSのセレクタが速度のネックになることはほとんどないと思います。

ただ、よかれと思って要素名を書いたりしてたので、少しでも高速化して他に影響がでないならできるかぎり高速化する書き方をしたほうがいいなと思いました。
